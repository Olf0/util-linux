From 3cf37d72b622403cbabe4f77cf26550b77231ff3 Mon Sep 17 00:00:00 2001
From: Marko Saukko <marko.saukko@jollamobile.com>
Date: Fri, 20 Jul 2012 22:45:45 +0000
Subject: [PATCH] Allow disabling of lscpu and prlimit from configure.

Signed-off-by: Marko Saukko <marko.saukko@jollamobile.com>
---
 configure.ac |   13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)

diff --git a/configure.ac b/configure.ac
index 3a3ab50..06348ae 100644
--- a/configure.ac
+++ b/configure.ac
@@ -890,8 +890,11 @@ UL_REQUIRES_LINUX([lsblk])
 UL_REQUIRES_BUILD([lsblk], [libblkid])
 AM_CONDITIONAL(BUILD_LSBLK, test "x$build_lsblk" = xyes)
 
-
-UL_BUILD_INIT([lscpu], [check])
+AC_ARG_ENABLE([lscpu],
+  AS_HELP_STRING([--disable-lscpu], [do not build lscpu]),
+  [], enable_lscpu=check
+)
+UL_BUILD_INIT([lscpu])
 UL_REQUIRES_LINUX([lscpu])
 UL_REQUIRES_HAVE([lscpu], [cpu_set_t], [cpu_set_t type])
 AM_CONDITIONAL(BUILD_LSCPU, test "x$build_lscpu" = xyes)
@@ -903,7 +906,11 @@ UL_REQUIRES_HAVE([chcpu], [cpu_set_t], [cpu_set_t type])
 AM_CONDITIONAL(BUILD_CHCPU, test "x$build_chcpu" = xyes)
 
 
-UL_BUILD_INIT([prlimit], [check])
+AC_ARG_ENABLE([prlimit],
+  AS_HELP_STRING([--disable-prlimit], [do not build prlimit]),
+  [], enable_prlimit=check
+)
+UL_BUILD_INIT([prlimit])
 UL_REQUIRES_LINUX([prlimit])
 UL_REQUIRES_SYSCALL_CHECK([prlimit], [UL_CHECK_SYSCALL([prlimit64])], [prlimit64])
 AM_CONDITIONAL(BUILD_PRLIMIT, test "x$build_prlimit" = xyes)
-- 
1.7.10.3

